<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head th:replace = "/fragments/head :: head"></head>
    <body class="bg-dark text-white">
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
        <nav th:replace = "/fragments/navbar :: nav"></nav>
        <main class="mt-5 px-5">
            <div th:if="${param.exito}" class="text-center">
                <p class="alert alert-info">Siniestro cargado Exitosamente!!</p>
            </div>
            <h2 class="pt-5">Lista de Siniestros</h2>
            <br>
            
            <table class="table table-striped table-bordered table-hover no-wrap">
                <thead class="table-dark no-wrap ">
                    <tr>
                        <th>Número Stro.</th>
                        <th>Fecha de Ingreso</th>
                        <th>Fecha de Vto.</th>
                        <th>Tipo de Stro.</th>
                        <th>Resultado</th>
                        <th>Fecha y Hora</th>
                        <th>Gravedad</th>
                        <th>Lesiones</th>
                        <th>Lugar del hecho</th>
                        <th>Entre Calles</th>
                        <th>Localidad</th>
                        <th>Provincia</th>
                        <th>Prestador Médico</th>
                        <th>Patologías Inculpables</th>
                        <th>Modificar</th>
                        <th>Eliminar</th>
                    </tr>
                </thead>
                <tbody class="table-dark ">
                    <tr th:each="siniestro : ${siniestros}">
                        <td th:text="${siniestro.numStro}"></td>
                        <td class="fecha" th:text="${siniestro.fechaIngreso}"></td>
                        <td class="fecha" th:text="${siniestro.fecha_vencimiento}"></td>
                        <td th:text="${siniestro.tipoStro}"></td>
                        <td th:text="${siniestro.resultado}"></td>
                        <td th:text="${siniestro.fechaYHoraStro}"></td>
                        <td th:text="${siniestro.gravedad}"></td>
                        <td th:text="${siniestro.lesiones}"></td>
                        <td th:text="${siniestro.lugar_direccion}"></td>
                        <td th:text="${siniestro.lugar_entrecalles}"></td>
                        <td th:text="${siniestro.localidad}"></td>
                        <td th:text="${siniestro.provincia}"></td>
                        <td th:text="${siniestro.nombrePrestadorMedico}"></td>                   
                        <td th:text="${siniestro.patologiasInculpables}"></td>

                        <td><a class="btn btn-success btn-sm">Modificar</a></td>
                        <td><a class="btn btn-danger btn-sm">Eliminar</a></td>
                    </tr>
                </tbody>
            </table>

        </main>
        <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Obtener todas las celdas con la clase "fecha"
      const fechaCeldas = document.querySelectorAll(".fecha");

      // Función para formatear la fecha
      function formatearFecha(fechaISO) {
        const fecha = new Date(fechaISO);
        const year = fecha.getFullYear();
        const month = String(fecha.getMonth() + 1).padStart(2, '0');
        const day = String(fecha.getDate()).padStart(2, '0');
        return `${day}-${month}-${year}`;
      }

      // Recorrer todas las celdas y formatear el contenido
      fechaCeldas.forEach(celda => {
        const fechaOriginal = celda.textContent.trim();
        celda.textContent = formatearFecha(fechaOriginal);
      });
    });
  </script>
    </body>
</html>